{% extends "base.html" %}
{% block title %}Вставка на сайт{% endblock %}
{% block content %}
<style>
    body {
        margin: 0;
    }
    .container {
        display: flex;
        flex-direction: column;
    }
    .spoiler-container {
        height: 50%;
        flex: 1;
        overflow-y: auto;
        padding: 20px;
        scrollbar-width: thin;
    }
    .item-specialty {
        border-color: #476DB3;
        box-shadow: 0 4px 8px #476DB340;
    }
    .item-profession {
        border-color: #8B45B9;
        box-shadow: 0 4px 8px #8B45B940;
    }
    .spoiler {
        border: 1px solid;
        margin: 10px 0;
        padding: 16px;
        border-radius: 20px;
    }
    .spoiler-header {
        cursor: pointer;
        font-weight: bold;
        color: black;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
    }
    .spoiler-content {
        display: none;
        padding: 10px;
        margin-top: 10px;
        border-top: 1px solid #ccc;
        color: black;
    }
    .spoiler-content.open {
        display: block;
    }
    .chevron-down-icon {
        width: 24px;
        height: 24px;
        transition: transform 0.3s ease-in-out;
    }
    .chevron-down-icon.rotated {
        transform: rotate(-180deg);
    }
    .code-window {
        height: 50%;
        border: 1px solid #ccc;
        margin-top: 20px;
        padding: 10px;
        overflow-y: auto;
        background-color: #282c34;
        color: #abb2bf;
        font-family: monospace;
        scrollbar-width: thin;
        position: relative;
    }
    .copy-button {
        background-color: #4CAF50;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 3px;
        cursor: pointer;
    }
    .copy-button:hover {
        background-color: #45a049;
    }
    .worker-card {
        display: grid;
        grid-template-columns: 1fr 1fr; /* Два равных столбца */
        gap: 10px;
        border: 1px solid #ddd;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 15px;
        background-color: #f9f9f9;
    }

    .worker-card .spoiler{border:1px solid #ccc}

    .worker-card h3 {
        grid-column: 1 / -1; /* Заголовок на всю ширину */
        margin-top: 0;
    }

    .worker-grid {
        display: contents; /* Позволяет элементам внутри grid распределяться автоматически */
    }
    .grid-row {
        display: grid;
        grid-template-columns: subgrid; /* Наследование колонок от родителя */
    }
    .grid-label {
        font-weight: 300;
        font-size: 10pt;
        color: gray;
        padding: 5px;
        border-radius: 3px;
    }
    .grid-value {
        padding: 5px;
        border-radius: 3px;
    }
</style>

<h1>Вставка на сайт</h1>
<button onclick="copyPageHTML()" class="copy-button">
    Copy Page HTML
</button>

<div class="container">
    <div class="spoiler-container">
        {% for item in items %}
        <div class="spoiler item-{% if item[2] %}specialty{% else %}profession{% endif %}">
            <div class="spoiler-header" onclick="toggleSpoiler(this)">
                <span>{{ item[1] }}</span>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-down-icon">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </div>
            <div class="spoiler-content">
                {% for worker in item_worker_details[item[0]] %}
                <div class="worker-card">
                    <h3>{{ worker[1] }}</h3>
                    <div class="worker-grid">
                        <div class="grid-row">
                            <div class="grid-label">Должность:</div>
                            <div class="grid-value">{{ worker[2] }}</div>
                        </div>
                        <div class="grid-row">
                            <div class="grid-label">Уровень образования:</div>
                            <div class="grid-value">{{ worker[3] }}</div>
                        </div>
                        <div class="grid-row">
                            <div class="grid-label">Наименование подготовки и (или) специальности:</div>
                            <div class="grid-value">{{ worker[4] }}</div>
                        </div>
                        <div class="grid-row">
                            <div class="grid-label">Квалификация:</div>
                            <div class="grid-value">{{ worker[5] }}</div>
                        </div>
                        <div class="grid-row">
                            <div class="grid-label">Ученая степень:</div>
                            <div class="grid-value">{{ worker[6] }}</div>
                        </div>
                        <div class="grid-row">
                            <div class="grid-label">Ученое звание:</div>
                            <div class="grid-value">{{ worker[7] }}</div>
                        </div>
                        <div class="grid-row">
                            <div class="grid-label">Общий стаж работы:</div>
                            <div class="grid-value">{{ worker[9] }}</div>
                        </div>
                        <div class="grid-row">
                            <div class="grid-label">Стаж работы по специальности:</div>
                            <div class="grid-value">{{ worker[10] }}</div>
                        </div>
                        <!-- Спойлер для "Повышение квалификации и профессиональная переподготовка" -->
                        <div class="spoiler">
                            <div class="spoiler-header" onclick="toggleNestedSpoiler(this)">
                                <span>Повышение квалификации и профессиональная переподготовка</span>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-down-icon">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </div>
                            <div class="spoiler-content">
                                {% if worker[8] %}
                                <ul>
                                    {% for line in worker[8].split('\n') if line.strip() %}
                                        <li>{{ line.strip() }}</li>
                                    {% endfor %}
                                </ul>
                            {% else %}
                                —
                            {% endif %}
                            </div>
                        </div>

                        <!-- Спойлер для "Преподаваемые учебные предметы, курсы, дисциплины (модули)" -->
                        <div class="spoiler">
                            <div class="spoiler-header" onclick="toggleNestedSpoiler(this)">
                                <span>Преподаваемые учебные предметы, курсы, дисциплины (модули)</span>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron-down-icon">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </div>
                            <div class="spoiler-content">
                            {% if worker[11] %}
                                <ul>
                                    {% for line in worker[11].split('\n') if line.strip() %}
                                        <li>{{ line.strip() }}</li>
                                    {% endfor %}
                                </ul>
                            {% else %}
                                —
                            {% endif %}  
                            </div>                          
                        </div>
                    </div>


                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>
<script>
    function toggleSpoiler(header) {
        const spoiler = header.parentElement;
        const content = header.nextElementSibling;
        const icon = header.querySelector('.chevron-down-icon');
        if (content.classList.contains('open')) {
            content.classList.remove('open');
            icon.classList.remove('rotated');
        } else {
            content.classList.add('open');
            icon.classList.add('rotated');
        }
    }
    function toggleNestedSpoiler(header) {
        const spoiler = header.parentElement;
        const content = header.nextElementSibling;
        const icon = header.querySelector('.chevron-down-icon');
        if (content.classList.contains('open')) {
            content.classList.remove('open');
            icon.classList.remove('rotated');
        } else {
            content.classList.add('open');
            icon.classList.add('rotated');
        }
    }
    function copyPageHTML() {
        // 1. Копируем все стили
        const styles = Array.from(document.querySelectorAll('style')).map(style => style.outerHTML).join('\n');

        // 2. Копируем ВСЕ скрипты (включая текущий)
        const scripts = Array.from(document.querySelectorAll('script')).map(script => script.outerHTML).join('\n');

        // 3. Копируем HTML-контент блока .container
        const container = document.querySelector('.container');
        if (!container) {
            alert('Блок .container не найден!');
            return;
        }
        const containerHTML = container.outerHTML;

        // 4. Формируем итоговый HTML
        const fullHTML = `
        ${styles}
        ${containerHTML}
        ${scripts}
        `.trim();

        // 5. Копируем в буфер обмена
        navigator.clipboard.writeText(fullHTML)
            .then(() => alert('HTML, CSS и JS успешно скопированы!'))
            .catch(err => {
                console.error('Ошибка копирования:', err);
                alert('Не удалось скопировать. См. консоль.');
            });
    }

</script>
{% endblock %}
